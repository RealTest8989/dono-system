{"ast":null,"code":"const SayPlatformBase = require('./base.js');\n\nconst BASE_SPEED = 100;\nconst COMMAND = 'festival';\n\nclass SayPlatformLinux extends SayPlatformBase {\n  constructor() {\n    super();\n    this.baseSpeed = BASE_SPEED;\n  }\n\n  buildSpeakCommand({\n    text,\n    voice,\n    speed\n  }) {\n    let args = [];\n    let pipedData = '';\n    let options = {};\n    args.push('--pipe');\n\n    if (speed) {\n      pipedData += `(Parameter.set 'Audio_Command \"aplay -q -c 1 -t raw -f s16 -r $(($SR*${this.convertSpeed(speed)}/100)) $FILE\") `;\n    }\n\n    if (voice) {\n      pipedData += `(${voice}) `;\n    }\n\n    pipedData += `(SayText \"${text}\")`;\n    return {\n      command: COMMAND,\n      args,\n      pipedData,\n      options\n    };\n  }\n\n  buildExportCommand({\n    text,\n    voice,\n    speed,\n    filename\n  }) {\n    throw new Error(`say.export(): does not support platform ${this.platform}`);\n  }\n\n  runStopCommand() {\n    // TODO: Need to ensure the following is true for all users, not just me. Danger Zone!\n    // On my machine, original childD.pid process is completely gone. Instead there is now a\n    // childD.pid + 1 sh process. Kill it and nothing happens. There's also a childD.pid + 2\n    // aplay process. Kill that and the audio actually stops.\n    process.kill(this.child.pid + 2);\n  }\n\n  getVoices() {\n    throw new Error(`say.export(): does not support platform ${this.platform}`);\n  }\n\n}\n\nmodule.exports = SayPlatformLinux;","map":{"version":3,"sources":["C:/Users/Lennart/Desktop/dono-system/node_modules/say/platform/linux.js"],"names":["SayPlatformBase","require","BASE_SPEED","COMMAND","SayPlatformLinux","constructor","baseSpeed","buildSpeakCommand","text","voice","speed","args","pipedData","options","push","convertSpeed","command","buildExportCommand","filename","Error","platform","runStopCommand","process","kill","child","pid","getVoices","module","exports"],"mappings":"AAAA,MAAMA,eAAe,GAAGC,OAAO,CAAC,WAAD,CAA/B;;AAEA,MAAMC,UAAU,GAAG,GAAnB;AACA,MAAMC,OAAO,GAAG,UAAhB;;AAEA,MAAMC,gBAAN,SAA+BJ,eAA/B,CAA+C;AAC7CK,EAAAA,WAAW,GAAI;AACb;AACA,SAAKC,SAAL,GAAiBJ,UAAjB;AACD;;AAEDK,EAAAA,iBAAiB,CAAE;AAAEC,IAAAA,IAAF;AAAQC,IAAAA,KAAR;AAAeC,IAAAA;AAAf,GAAF,EAA0B;AACzC,QAAIC,IAAI,GAAG,EAAX;AACA,QAAIC,SAAS,GAAG,EAAhB;AACA,QAAIC,OAAO,GAAG,EAAd;AAEAF,IAAAA,IAAI,CAACG,IAAL,CAAU,QAAV;;AAEA,QAAIJ,KAAJ,EAAW;AACTE,MAAAA,SAAS,IAAK,wEAAuE,KAAKG,YAAL,CAAkBL,KAAlB,CAAyB,iBAA9G;AACD;;AAED,QAAID,KAAJ,EAAW;AACTG,MAAAA,SAAS,IAAK,IAAGH,KAAM,IAAvB;AACD;;AAEDG,IAAAA,SAAS,IAAK,aAAYJ,IAAK,IAA/B;AAEA,WAAO;AAAEQ,MAAAA,OAAO,EAAEb,OAAX;AAAoBQ,MAAAA,IAApB;AAA0BC,MAAAA,SAA1B;AAAqCC,MAAAA;AAArC,KAAP;AACD;;AAEDI,EAAAA,kBAAkB,CAAE;AAAET,IAAAA,IAAF;AAAQC,IAAAA,KAAR;AAAeC,IAAAA,KAAf;AAAsBQ,IAAAA;AAAtB,GAAF,EAAoC;AACpD,UAAM,IAAIC,KAAJ,CAAW,2CAA0C,KAAKC,QAAS,EAAnE,CAAN;AACD;;AAEDC,EAAAA,cAAc,GAAI;AAChB;AACA;AACA;AACA;AACAC,IAAAA,OAAO,CAACC,IAAR,CAAa,KAAKC,KAAL,CAAWC,GAAX,GAAiB,CAA9B;AACD;;AAEDC,EAAAA,SAAS,GAAI;AACX,UAAM,IAAIP,KAAJ,CAAW,2CAA0C,KAAKC,QAAS,EAAnE,CAAN;AACD;;AAxC4C;;AA2C/CO,MAAM,CAACC,OAAP,GAAiBxB,gBAAjB","sourcesContent":["const SayPlatformBase = require('./base.js')\n\nconst BASE_SPEED = 100\nconst COMMAND = 'festival'\n\nclass SayPlatformLinux extends SayPlatformBase {\n  constructor () {\n    super()\n    this.baseSpeed = BASE_SPEED\n  }\n\n  buildSpeakCommand ({ text, voice, speed }) {\n    let args = []\n    let pipedData = ''\n    let options = {}\n\n    args.push('--pipe')\n\n    if (speed) {\n      pipedData += `(Parameter.set 'Audio_Command \"aplay -q -c 1 -t raw -f s16 -r $(($SR*${this.convertSpeed(speed)}/100)) $FILE\") `\n    }\n\n    if (voice) {\n      pipedData += `(${voice}) `\n    }\n\n    pipedData += `(SayText \"${text}\")`\n\n    return { command: COMMAND, args, pipedData, options }\n  }\n\n  buildExportCommand ({ text, voice, speed, filename }) {\n    throw new Error(`say.export(): does not support platform ${this.platform}`)\n  }\n\n  runStopCommand () {\n    // TODO: Need to ensure the following is true for all users, not just me. Danger Zone!\n    // On my machine, original childD.pid process is completely gone. Instead there is now a\n    // childD.pid + 1 sh process. Kill it and nothing happens. There's also a childD.pid + 2\n    // aplay process. Kill that and the audio actually stops.\n    process.kill(this.child.pid + 2)\n  }\n\n  getVoices () {\n    throw new Error(`say.export(): does not support platform ${this.platform}`)\n  }\n}\n\nmodule.exports = SayPlatformLinux\n"]},"metadata":{},"sourceType":"script"}