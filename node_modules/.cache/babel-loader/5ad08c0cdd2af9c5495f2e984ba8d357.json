{"ast":null,"code":"import _classCallCheck from\"C:\\\\Users\\\\Lennart\\\\Desktop\\\\dono-system\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\Lennart\\\\Desktop\\\\dono-system\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\Lennart\\\\Desktop\\\\dono-system\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\Lennart\\\\Desktop\\\\dono-system\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from'react';import axios from'axios';import'../alertbox.css';import Speech from'speak-tts';import ReactPlayer from'react-player';import Donation_Alert from'../donation-alert.mp3';var Alertbox=/*#__PURE__*/function(_Component){_inherits(Alertbox,_Component);var _super=_createSuper(Alertbox);function Alertbox(props){var _this;_classCallCheck(this,Alertbox);_this=_super.call(this,props);_this.state={loaded:false,tts_finished:false,playing:false};return _this;}_createClass(Alertbox,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;setInterval(function(){if(!_this2.state.playing){axios.get('http://localhost:5000/donations/queue').then(function(response){_this2.setState({donations:response.data,loaded:true,tts_finished:false});}).catch(function(error){console.log(error);});}},10000);}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps,prevState,snapshot){var _this3=this;if(this.state.donations[0]!=null){console.log(this.state.donations[0]);}else{console.log('No donation found.');}if(prevState.donations!=this.state.donations){if(this.state.donations[0]!=null){var donation={id:this.state.donations[0]._id,username:this.state.donations[0].username,message:this.state.donations[0].message,amount:this.state.donations[0].amount,media_url:this.state.donations[0].media_url,start_time:this.state.donations[0].start_time,played:true};this.setState({playing:true});axios.post('http://localhost:5000/donations/update/'+donation.id,donation).then(function(res){return console.log(res.data);});var donation_alert_file=document.getElementsByClassName(\"donation-alert\")[0];donation_alert_file.play();var speech=new Speech();speech.setLanguage('en-GB');speech.setPitch(1);speech.setRate(0.8);setTimeout(function(){return speech.speak({text:\"\".concat(donation.username,\" donated $\").concat(donation.amount,\" \").concat(donation.message),listeners:{onend:function onend(){_this3.setState({tts_finished:true});if(donation.media_url){setTimeout(function(){_this3.setState({playing:false});},30000);}else{_this3.setState({playing:false});}}}});},5800);}}}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"alertbox\"},this.state.tts_finished&&this.state.donations[0].media_url?/*#__PURE__*/React.createElement(ReactPlayer,{url:this.state.donations[0].media_url,width:\"0\",height:\"0\",config:{youtube:{playerVars:{start:this.state.donations[0].start_time,end:this.state.donations[0].start_time+30}}},playing:true}):/*#__PURE__*/React.createElement(\"div\",null),this.state.loaded&&this.state.donations[0]?/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"audio\",{className:\"donation-alert\"},/*#__PURE__*/React.createElement(\"source\",{src:Donation_Alert})),/*#__PURE__*/React.createElement(\"div\",{id:\"alert\"},/*#__PURE__*/React.createElement(\"div\",{className:\"donation\"},/*#__PURE__*/React.createElement(\"span\",{className:\"alert-color\"},this.state.donations[0].username?this.state.donations[0].username:'Anonymous'),\" donated \",/*#__PURE__*/React.createElement(\"span\",{className:\"alert-color\"},\"$\",this.state.donations[0].amount),\"!\"),/*#__PURE__*/React.createElement(\"div\",{className:\"message\"},this.state.donations[0].message?this.state.donations[0].message:'')),/*#__PURE__*/React.createElement(\"div\",{id:\"player\"})):/*#__PURE__*/React.createElement(\"div\",null)));}}]);return Alertbox;}(Component);export{Alertbox as default};","map":{"version":3,"sources":["C:/Users/Lennart/Desktop/dono-system/src/components/alertbox.component.js"],"names":["React","Component","axios","Speech","ReactPlayer","Donation_Alert","Alertbox","props","state","loaded","tts_finished","playing","setInterval","get","then","response","setState","donations","data","catch","error","console","log","prevProps","prevState","snapshot","donation","id","_id","username","message","amount","media_url","start_time","played","post","res","donation_alert_file","document","getElementsByClassName","play","speech","setLanguage","setPitch","setRate","setTimeout","speak","text","listeners","onend","youtube","playerVars","start","end"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport axios from 'axios';\r\nimport '../alertbox.css';\r\nimport Speech from 'speak-tts';\r\nimport ReactPlayer from 'react-player';\r\nimport Donation_Alert from '../donation-alert.mp3'\r\n\r\nexport default class Alertbox extends Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            loaded: false,\r\n            tts_finished: false,\r\n            playing: false\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        setInterval(() => {\r\n            if(!this.state.playing){\r\n                axios.get('http://localhost:5000/donations/queue')\r\n                .then(response => {\r\n                this.setState({ donations: response.data, loaded: true, tts_finished: false })\r\n                })\r\n                .catch((error) => {\r\n                    console.log(error);\r\n                });\r\n            }\r\n        }, 10000);\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState, snapshot) {\r\n        if(this.state.donations[0] != null){\r\n            console.log(this.state.donations[0]);\r\n        } else {\r\n            console.log('No donation found.')\r\n        }\r\n\r\n        if(prevState.donations != this.state.donations){\r\n            if(this.state.donations[0] != null){\r\n                const donation = {\r\n                    id: this.state.donations[0]._id,\r\n                    username: this.state.donations[0].username,\r\n                    message: this.state.donations[0].message,\r\n                    amount: this.state.donations[0].amount,\r\n                    media_url: this.state.donations[0].media_url,\r\n                    start_time: this.state.donations[0].start_time,\r\n                    played: true\r\n                }\r\n    \r\n                this.setState({playing: true});\r\n    \r\n                axios.post('http://localhost:5000/donations/update/' + donation.id, donation)\r\n                .then(res => console.log(res.data));\r\n        \r\n                const donation_alert_file = document.getElementsByClassName(\"donation-alert\")[0];\r\n                donation_alert_file.play();\r\n        \r\n                const speech = new Speech();\r\n        \r\n                speech.setLanguage('en-GB');\r\n                speech.setPitch(1);\r\n                speech.setRate(0.8);\r\n        \r\n                \r\n                setTimeout(() => speech.speak({\r\n                        text: `${donation.username} donated $${donation.amount} ${donation.message}`,\r\n                        listeners: {\r\n                            onend: () => {\r\n                                this.setState({ tts_finished: true });\r\n                                if(donation.media_url){\r\n                                setTimeout(() => {\r\n                                    this.setState({playing: false});\r\n                                }, 30000);\r\n                                } else {\r\n                                    this.setState({playing: false});\r\n                                }\r\n                            }\r\n                        }\r\n                }), 5800);\r\n            }\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"container\">\r\n                <div className=\"alertbox\">\r\n                    { this.state.tts_finished && this.state.donations[0].media_url ? \r\n                    <ReactPlayer\r\n                        url={this.state.donations[0].media_url} \r\n                        width='0'\r\n                        height='0' \r\n                        config={{\r\n                            youtube: {\r\n                            playerVars: { start: this.state.donations[0].start_time, end: this.state.donations[0].start_time + 30 }\r\n                            }\r\n                        }}\r\n                        playing\r\n                    />\r\n                    : <div></div>\r\n                    }\r\n\r\n                    {this.state.loaded && this.state.donations[0] ? \r\n                    <div>\r\n                        <audio className=\"donation-alert\">\r\n                            <source src={Donation_Alert}></source>\r\n                        </audio>\r\n                        <div id=\"alert\">\r\n                        <div className=\"donation\"><span className=\"alert-color\">{ this.state.donations[0].username ? this.state.donations[0].username : 'Anonymous'}</span> donated <span className=\"alert-color\">${this.state.donations[0].amount}</span>!</div>\r\n                        <div className=\"message\">{this.state.donations[0].message ? this.state.donations[0].message : '' }</div>\r\n                        </div>\r\n                        <div id=\"player\"></div>\r\n                    </div>\r\n                    : <div></div>\r\n                    }\r\n\r\n                </div>\r\n            </div>\r\n        );\r\n\r\n    }\r\n\r\n    \r\n}\r\n"]},"metadata":{},"sourceType":"module"}